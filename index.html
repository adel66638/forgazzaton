<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بوابة دفع TON | الرسمية</title>
    
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    
    <style>
        :root { --main-blue: #0088cc; --bg-dark: #0e1621; --card-bg: #1b2633; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-dark); color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: var(--card-bg); padding: 35px; border-radius: 24px; box-shadow: 0 15px 35px rgba(0,0,0,0.4); text-align: center; width: 90%; max-width: 400px; border: 1px solid #2c3b4d; }
        h2 { margin: 0 0 10px; font-size: 24px; color: var(--main-blue); }
        p { color: #8a99a8; margin-bottom: 25px; line-height: 1.5; }
        #ton-connect-button { display: flex; justify-content: center; margin-bottom: 25px; }
        .btn-send { background: linear-gradient(45deg, #0088cc, #00aaff); color: white; border: none; padding: 16px; border-radius: 12px; font-size: 18px; font-weight: bold; width: 100%; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 15px rgba(0,136,204,0.3); }
        .btn-send:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,136,204,0.5); }
        .btn-send:active { transform: translateY(0); }
        .footer-note { margin-top: 20px; font-size: 12px; color: #5a6b7d; }
    </style>
</head>
<body>

    <div class="card">
        <h2>بوابة دفع TON</h2>
        <p>اربط محفظتك (Tonkeeper, MyTonWallet) لتنفيذ المعاملة بأمان.</p>
        
        <div id="ton-connect-button"></div>
        
        <button class="btn-send" id="send-btn">إرسال 0.1 TON</button>
        
        <div class="footer-note">العملية تتم عبر بروتوكول TonConnect المشفر</div>
    </div>

    <script>
        // 1. تهيئة الواجهة والربط
        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifestUrl: 'https://raw.githubusercontent.com/ton-connect/demo-dapp-with-react/master/public/tonconnect-manifest.json',
            buttonRootId: 'ton-connect-button'
        });

        // 2. معالجة زر الإرسال
        document.getElementById('send-btn').onclick = async () => {
            // التحقق من الاتصال
            if (!tonConnectUI.connected) {
                alert("الرجاء الضغط على زر Connect Wallet أولاً");
                return;
            }

            // تفاصيل المعاملة (مأخوذة من لقطة الشاشة الخاصة بك)
            const transaction = {
                validUntil: Math.floor(Date.now() / 1000) + 360, // صلاحية المعاملة 6 دقائق
                messages: [
                    {
                        address: "t4iKHyyoXD0Spm8N9navPx", // عنوان محفظتك
                        amount: "100000000" // القيمة: 0.1 TON
                    }
                ]
            };

            try {
                const result = await tonConnectUI.sendTransaction(transaction);
                console.log("Success:", result);
                alert("تم إرسال طلب المعاملة لمحفظتك بنجاح!");
            } catch (e) {
                console.error("Error:", e);
                alert("حدث خطأ: تأكد من وجود رصيد كافٍ أو أنك لم تلغِ العملية.");
            }
        };
    </script>
</body>
</html>
